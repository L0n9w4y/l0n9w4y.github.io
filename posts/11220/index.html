<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.2.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/blog-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/blog-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic%7CRoboto+Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"l0n9w4y.cc","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.13.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":"default"},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="OWASP Top 10 漏洞指南简要记录...">
<meta property="og:type" content="article">
<meta property="og:title" content="OWASP TOP 10 漏洞浅析">
<meta property="og:url" content="https://l0n9w4y.cc/posts/11220/index.html">
<meta property="og:site_name" content="L0n9w4y">
<meta property="og:description" content="OWASP Top 10 漏洞指南简要记录...">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2018-04-23T12:38:23.000Z">
<meta property="article:modified_time" content="2023-03-11T11:42:27.114Z">
<meta property="article:author" content="L0n9w4y">
<meta property="article:tag" content="Vulnerability">
<meta property="article:tag" content="OWASP">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://l0n9w4y.cc/posts/11220/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://l0n9w4y.cc/posts/11220/","path":"posts/11220/","title":"OWASP TOP 10 漏洞浅析"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>OWASP TOP 10 漏洞浅析 | L0n9w4y</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">L0n9w4y</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-攻防"><a href="/A&D/" rel="section"><i class="fa fa-navicon fa-fw"></i>攻防</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x00-%E6%BC%8F%E6%B4%9E%E7%AE%80%E8%BF%B0"><span class="nav-text">0x00 漏洞简述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-%E6%B3%A8%E5%85%A5"><span class="nav-text">0x01 注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%B3%A8%E5%85%A5%E7%82%B9"><span class="nav-text">1. 注入点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%BD%B1%E5%93%8D%E5%8D%B1%E5%AE%B3"><span class="nav-text">2. 影响危害</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF"><span class="nav-text">3. 绕过姿势</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD"><span class="nav-text">4. 防御措施</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-%E5%A4%B1%E6%95%88%E7%9A%84%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81%E5%92%8C%E4%BC%9A%E8%AF%9D%E7%AE%A1%E7%90%86"><span class="nav-text">0x02 失效的身份认证和会话管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%84%86%E5%BC%B1%E7%82%B9"><span class="nav-text">1. 脆弱点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%BD%B1%E5%93%8D%E5%8D%B1%E5%AE%B3-1"><span class="nav-text">2. 影响危害</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD"><span class="nav-text">3. 防御措施</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-%E6%95%8F%E6%84%9F%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2"><span class="nav-text">0x03 敏感数据泄露</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E6%BC%8F%E6%B4%9E%E6%88%90%E5%9B%A0"><span class="nav-text">1. 漏洞成因</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E8%84%86%E5%BC%B1%E7%82%B9"><span class="nav-text">2. 脆弱点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD-1"><span class="nav-text">3. 防御措施</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF"><span class="nav-text">4. 攻击场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-XML-%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%EF%BC%88XXE%EF%BC%89"><span class="nav-text">0x04 XML 外部实体（XXE）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%87%BA%E7%8E%B0%E5%9C%BA%E6%99%AF"><span class="nav-text">1. 出现场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%BD%B1%E5%93%8D%E5%8D%B1%E5%AE%B3-2"><span class="nav-text">2. 影响危害</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%94%BB%E5%87%BB%E6%96%B9%E5%BC%8F"><span class="nav-text">3. 攻击方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD-2"><span class="nav-text">3. 防御措施</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF-1"><span class="nav-text">4. 攻击场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x05-%E5%A4%B1%E6%95%88%E7%9A%84%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6"><span class="nav-text">0x05 失效的访问控制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%84%86%E5%BC%B1%E7%82%B9-1"><span class="nav-text">1. 脆弱点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%BD%B1%E5%93%8D%E5%8D%B1%E5%AE%B3-3"><span class="nav-text">2. 影响危害</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD-3"><span class="nav-text">3. 防御措施</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x06-%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF"><span class="nav-text">0x06 安全配置错误</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%84%86%E5%BC%B1%E7%82%B9-2"><span class="nav-text">1. 脆弱点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD"><span class="nav-text">2. 防御措施</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF"><span class="nav-text">3. 攻击场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x07-%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%EF%BC%88XSS%EF%BC%89"><span class="nav-text">0x07 跨站脚本（XSS）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-XSS%E7%B1%BB%E5%9E%8B"><span class="nav-text">1. XSS类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E5%BD%B1%E5%93%8D%E5%8D%B1%E5%AE%B3-4"><span class="nav-text">2. 影响危害</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD-4"><span class="nav-text">3. 防御措施</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x08-%E4%B8%8D%E5%AE%89%E5%85%A8%E7%9A%84%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-text">0x08 不安全的反序列化</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%84%86%E5%BC%B1%E7%82%B9-3"><span class="nav-text">1. 脆弱点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD-1"><span class="nav-text">2. 防御措施</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E6%94%BB%E5%87%BB%E5%9C%BA%E6%99%AF-1"><span class="nav-text">3. 攻击场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x09-%E4%BD%BF%E7%94%A8%E5%90%AB%E6%9C%89%E5%B7%B2%E7%9F%A5%E6%BC%8F%E6%B4%9E%E7%9A%84%E7%BB%84%E4%BB%B6"><span class="nav-text">0x09 使用含有已知漏洞的组件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%84%86%E5%BC%B1%E7%82%B9-4"><span class="nav-text">1. 脆弱点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD-2"><span class="nav-text">2. 防御措施</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x0A-%E4%B8%8D%E8%B6%B3%E7%9A%84%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%E5%92%8C%E7%9B%91%E6%8E%A7"><span class="nav-text">0x0A 不足的日志记录和监控</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E8%84%86%E5%BC%B1%E7%82%B9-5"><span class="nav-text">1. 脆弱点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E9%98%B2%E5%BE%A1%E6%8E%AA%E6%96%BD-3"><span class="nav-text">2. 防御措施</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0xFF-Reference"><span class="nav-text">0xFF Reference</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="L0n9w4y"
      src="/images/hexo.png">
  <p class="site-author-name" itemprop="name">L0n9w4y</p>
  <div class="site-description" itemprop="description">問道遠兮，求索未止...</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">43</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/L0n9w4y" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;L0n9w4y" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/l0n9w4y" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;l0n9w4y" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/_L0n9_" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;_L0n9_" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://l0n9w4y.cc/posts/11220/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/hexo.png">
      <meta itemprop="name" content="L0n9w4y">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="L0n9w4y">
      <meta itemprop="description" content="問道遠兮，求索未止...">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="OWASP TOP 10 漏洞浅析 | L0n9w4y">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          OWASP TOP 10 漏洞浅析
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-04-23 20:38:23" itemprop="dateCreated datePublished" datetime="2018-04-23T20:38:23+08:00">2018-04-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%BC%8F%E6%B4%9E%E7%A0%94%E7%A9%B6/" itemprop="url" rel="index"><span itemprop="name">漏洞研究</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <center>OWASP Top 10 漏洞指南简要记录...</center>

<span id="more"></span>

<h2 id="0x00-漏洞简述"><a href="#0x00-漏洞简述" class="headerlink" title="0x00 漏洞简述"></a>0x00 漏洞简述</h2><ol>
<li><p>注入攻击（Injection）：注入攻击是一种通过输入非法字符或者数据来欺骗程序自行执行恶意代码或者命令的攻击方式。最常见的注入攻击是 SQL 注入攻击和 OS 命令注入攻击。</p>
</li>
<li><p>失效的身份认证和会话管理（Broken Authentication and Session Management）：该漏洞主要是指应用程序中身份认证和会话管理方案的设计不够严密，导致攻击者可以盗取用户的身份凭证，包括用户名、密码、会话ID等，从而获取用户的权限。</p>
</li>
<li><p>敏感数据泄露（Sensitive Data Exposure）：该漏洞主要是指应用程序未能保护存储在数据库中的敏感数据，如信用卡号码、密码等，这些数据被攻击者盗取后可能会导致用户隐私泄露。</p>
</li>
<li><p>XML外部实体注入漏洞（XML External Entities, XXE）：XML外部实体注入漏洞是一种基于XML解析器的漏洞，攻击者可以通过注入恶意实体来读取文件、执行命令等，最终导致应用程序的机密数据泄露。</p>
</li>
<li><p>失效的访问控制（Broken Access Control）：失效的访问控制指应用程序中对资源的访问控制机制存在缺陷，攻击者可以通过暴力破解、会话劫持、参数篡改等方式绕过访问控制机制，访问未授权的资源。</p>
</li>
<li><p>安全配置错误（Security Misconfiguration）：安全配置错误指应用程序的安全配置不当，比如不安全的默认设置、过度授权等，导致攻击者可以通过轻松的方式获取系统的权限和机密数据。</p>
</li>
<li><p>跨站脚本攻击（XSS）：跨站脚本攻击是一种利用 Web 页面脚本漏洞实施的攻击，攻击者可以通过注入脚本代码，例如恶意 JavaScript 脚本等，来盗取用户的身份信息或者在用户的浏览器中执行恶意代码。</p>
</li>
<li><p>不安全的反序列化（Insecure Deserialization）：反序列化是将序列化后的对象还原成原始对象的过程。不安全的反序列化攻击是一种通过篡改序列化数据来执行任意代码的攻击。攻击者可以在序列化数据中注入恶意数据，当反序列化时，这些恶意数据会被解析并执行。</p>
</li>
<li><p>使用含有已知漏洞的组件（Using Components with Known Vulnerabilities）：许多 Web 应用程序使用第三方组件和库来实现特定功能，如图像处理、邮件发送等。如果这些组件和库存在已知漏洞，攻击者可以利用这些漏洞来攻击应用程序。</p>
</li>
<li><p>不足的日志记录和监控（Insufficient Logging and Monitoring）：不足的日志记录和监控使得应用程序很难检测和响应攻击事件。攻击者可以通过绕过日志记录、擦除日志等方式来隐藏攻击痕迹，从而逃避检测和追踪。</p>
</li>
</ol>
<h2 id="0x01-注入"><a href="#0x01-注入" class="headerlink" title="0x01 注入"></a>0x01 注入</h2><p><strong>原理：</strong> 注入攻击（Injection）是一种利用应用程序的输入验证不严格或缺乏输入验证机制，从而允许攻击者通过构造恶意输入，将恶意代码或命令注入到应用程序的后台数据库或操作系统中，访问敏感数据甚至获取系统权限。</p>
<h3 id="1-注入点"><a href="#1-注入点" class="headerlink" title="1. 注入点"></a>1. 注入点</h3><p>当应用在如下时点时，是脆弱的并易受到攻击：</p>
<ul>
<li>用户提供的数据没有经过应用程序的验证、过滤或净化。</li>
<li>动态查询语句或非参数化的调用，在没有上下文感知转义的情况下，被用于解释器。</li>
<li>在ORM搜索参数中使用了恶意数据，这样搜索就获得包含敏感或未授权的数据。</li>
<li>恶意数据直接被使用或连接，诸如SQL语句或命令在动态查询语句、命令或存储过程中包含结构和恶意数据。</li>
</ul>
<p>注入漏洞通常能在SQL、LDAP、XPath或是NoSQL查询语句、OS命令、XML解析器、SMTP包头、表达式语句及ORM查询语句中找到。</p>
<p>一些常见的注入，包括：SQL、OS命令、ORM、LDAP和表达式语言（EL）或OGNL注入。</p>
<p><strong>注入类型</strong></p>
<ul>
<li><p>SQL 注入攻击：攻击者通过在 SQL 查询语句中注入恶意代码，从而获取数据库中的机密数据或者控制数据库的操作。例如，攻击者可以通过在用户名或密码输入框中输入 ‘ or ‘1’&#x3D;’1 这样的语句，绕过验证，获取所有用户信息的权限。</p>
</li>
<li><p>OS 命令注入攻击：攻击者通过在应用程序的命令行参数中注入恶意代码，执行任意的操作，例如上传或者下载文件，执行系统命令等。例如，攻击者可以在应用程序的搜索框中输入 &amp;&amp; ls，来执行系统命令 ls 并列出文件列表。</p>
</li>
<li><p>LDAP 注入攻击：攻击者通过在 LDAP 查询语句中注入恶意代码，从而获取目录服务器中的机密数据或者控制服务器的操作。例如，攻击者可以通过在用户名或密码输入框中输入 <code>)(&amp;(objectClass=))</code> 这样的语句，获取所有用户信息的权限。</p>
</li>
<li><p>ORM注入攻击：ORM (Object-Relational Mapping) 是一种编程技术，用于将关系数据库中的数据转换为面向对象的编程语言中的对象。ORM 注入是指攻击者利用不当使用ORM的漏洞，向ORM框架注入恶意代码来获取或者篡改数据。</p>
</li>
<li><p>表达式语言（EL）或OGNL注入：表达式语言（EL）和OGNL (Object-Graph Navigation Language) 是一种用于在 Web 应用程序中动态执行表达式的语言。EL 和 OGNL 注入是指攻击者利用不当使用 EL 或 OGNL 的漏洞，向 Web 应用程序注入恶意代码来获取或篡改数据。</p>
</li>
<li><p>XPath 注入攻击：攻击者通过在 XML 数据中注入恶意代码，执行任意的操作，例如获取机密数据或者控制系统。例如，攻击者可以通过在搜索框中输入 ‘ or 1&#x3D;1 or ‘a’&#x3D;’a，来绕过验证并获取所有用户信息。</p>
</li>
<li><p>CRLF注入：CRLF注入攻击是通过在HTTP头中注入CRLF字符（Carriage Return和Line Feed），从而实现在Web应用程序中执行任意操作的攻击。</p>
</li>
</ul>
<p><strong>注入点</strong></p>
<ul>
<li><p>用户输入参数：包括用户名、密码、搜索查询、表单字段等。</p>
</li>
<li><p>HTTP 请求头：包括 Cookie、Referer 等。</p>
</li>
<li><p>SQL 语句参数：应用程序中直接使用用户输入的参数构建 SQL 语句。</p>
</li>
<li><p>LDAP 查询参数：应用程序中直接使用用户输入的参数构建 LDAP 查询语句。</p>
</li>
<li><p>操作系统命令参数：应用程序中直接使用用户输入的参数构建操作系统命令。</p>
</li>
<li><p>Cookie：如果攻击者能够注入Cookie值，就能够伪造用户身份并执行恶意操作。</p>
</li>
</ul>
<h3 id="2-影响危害"><a href="#2-影响危害" class="headerlink" title="2. 影响危害"></a>2. 影响危害</h3><p>注入能导致数据丢失、破坏或泄露给无授权方，缺乏可审计性或是拒绝服务。注入有时甚至能导致主机被完全接管。</p>
<h3 id="3-绕过姿势"><a href="#3-绕过姿势" class="headerlink" title="3. 绕过姿势"></a>3. 绕过姿势</h3><ul>
<li><p>使用编码绕过：攻击者使用特殊的编码方式对注入载荷进行编码，使得它可以绕过输入验证和过滤机制。例如，将特殊字符编码成十六进制或Unicode编码。</p>
</li>
<li><p>使用注释符绕过：攻击者可以使用注释符（例如 “–”）将载荷分成两部分，注释符后面的部分可以被忽略，这样就可以绕过输入验证和过滤机制。</p>
</li>
<li><p>使用空格绕过：攻击者可以在注入载荷中使用空格，从而使得输入验证和过滤机制无法识别注入载荷的存在。</p>
</li>
<li><p>混淆语句结构绕过：攻击者可以使用特殊的语句结构和关键字组合，使得注入语句可以绕过输入验证和过滤机制，例如使用UNION SELECT语句，或者使用特殊的MySQL函数等。</p>
</li>
<li><p>使用时间延迟绕过：攻击者可以在注入语句中使用时间延迟函数，使得注入语句的执行时间变长，从而绕过输入验证和过滤机制。</p>
</li>
<li><p>使用多重查询绕过：攻击者可以在注入语句中使用多重查询，使得注入语句可以绕过输入验证和过滤机制。</p>
</li>
<li><p>使用分段绕过：攻击者可以将攻击载荷分成多个片段，每个片段都可以通过WAF的检测，然后再将它们组合起来执行攻击。</p>
</li>
<li><p>使用代理绕过：攻击者可以使用代理服务器来转发攻击请求，以绕过WAF的检测。</p>
</li>
</ul>
<h3 id="4-防御措施"><a href="#4-防御措施" class="headerlink" title="4. 防御措施"></a>4. 防御措施</h3><ul>
<li><p>使用参数化查询或预处理语句：在编写 SQL 查询语句时，应该使用参数化查询或预处理语句来减少 SQL 注入的风险。</p>
</li>
<li><p>验证与过滤用户输入：在接受和处理用户输入数据时，需要对数据进行过滤和验证，以确保输入数据符合预期的格式和类型，并不包含任何恶意代码。</p>
</li>
<li><p>限制数据库用户权限：应该将数据库用户的权限最小化，只赋予其必要的权限，以限制注入攻击的危害范围。</p>
</li>
<li><p>最小化信息泄露：系统应该尽可能减少对攻击者有用的错误信息和调试信息的泄露，例如，错误消息应该尽可能不包含敏感信息。</p>
</li>
<li><p>使用最新版本的软件和框架：使用最新版本的软件和框架可以减少已知漏洞的风险。</p>
</li>
<li><p>加强敏感数据保护：对于敏感数据，采用加密、隔离等措施，确保数据的机密性和完整性。</p>
</li>
</ul>
<h2 id="0x02-失效的身份认证和会话管理"><a href="#0x02-失效的身份认证和会话管理" class="headerlink" title="0x02 失效的身份认证和会话管理"></a>0x02 失效的身份认证和会话管理</h2><p>原理：攻击者利用系统中存在的安全漏洞，绕过或破解身份认证或会话管理机制，从而获得未经授权的访问或操作权限。</p>
<h3 id="1-脆弱点"><a href="#1-脆弱点" class="headerlink" title="1. 脆弱点"></a>1. 脆弱点</h3><p>如果您的应用程序存在如下问题，那么可能存在身份验证的脆弱性：</p>
<ul>
<li>允许凭证填充，这使得攻击者获得有效用户名和密码的列表。</li>
<li>允许暴力破解或其他自动攻击。</li>
<li>允许默认的、弱的或众所周知的密码，例如”Password1”或”admin&#x2F;admin”。</li>
<li>使用弱的或失效的验证凭证，忘记密码程序，例如”基于知识的答案”，这是不安全的。</li>
<li>使用明文、加密或弱散列密码（参见：A3:2017-敏感数据泄露）。</li>
<li>缺少或失效的多因素身份验证。</li>
<li>暴露URL中的会话ID（例如URL重写）。</li>
<li>在成功登录后不会更新会话ID。</li>
<li>不正确地使会话ID失效。当用户不活跃的时候，用户会话或认证令牌（特别是单点登录（SSO）令牌）没有正确注销或失效。</li>
</ul>
<h3 id="2-影响危害-1"><a href="#2-影响危害-1" class="headerlink" title="2. 影响危害"></a>2. 影响危害</h3><p>失效的身份认证和会话管理漏洞可能导致攻击者窃取用户身份、越权访问、篡改数据等严重后果。</p>
<ul>
<li><p>身份验证绕过：攻击者可以使用无效的身份验证绕过身份验证机制，获得未授权的访问权限。</p>
</li>
<li><p>帐户劫持：攻击者可以通过会话劫持或会话固定攻击获取已认证用户的会话令牌，并利用该令牌访问用户帐户。</p>
</li>
<li><p>数据泄露：攻击者可以访问未经授权的数据，例如，用户凭据、敏感数据和客户机存储的信息等。</p>
</li>
<li><p>篡改数据：攻击者可以使用劫持的会话令牌篡改数据，例如修改个人资料、更改密码等。</p>
</li>
<li><p>恶意用户假冒：攻击者可以使用劫持的会话令牌冒充认证用户，执行各种恶意操作，例如转移资金或修改订单等。</p>
</li>
<li><p>泄露机密数据：攻击者可以利用受攻击的会话绕过访问控制机制，访问敏感数据或机密信息。</p>
</li>
</ul>
<h3 id="3-防御措施"><a href="#3-防御措施" class="headerlink" title="3. 防御措施"></a>3. 防御措施</h3><p>在可能的情况下，实现多因素身份验证，以防止自动、凭证填充、暴力破解和被盗凭据再利用攻击。</p>
<ul>
<li><p>使用强密码：强密码包括大小写字母、数字和特殊字符，避免使用易于猜测的密码，比如生日、常用数字、常见单词等。</p>
</li>
<li><p>实施多重身份验证：使用多因素身份验证可以提高系统的安全性，例如使用短信验证码、动态口令令牌等。</p>
</li>
<li><p>禁止使用默认密码：在部署新系统时，需要修改默认密码，否则可能被攻击者轻易破解。</p>
</li>
<li><p>限制登录尝试次数：在系统中设置登录失败次数限制，过多的失败尝试将锁定账号或者增加等待时间，以减少暴力破解的风险。</p>
</li>
<li><p>定期更新和轮换密码：对于敏感账号或者管理账号，建议定期更新和轮换密码，避免长期使用同一密码。</p>
</li>
<li><p>增强会话安全性：使用HTTPS协议传输会话数据，避免使用HTTP明文传输，同时确保会话仅在必要时才处于活动状态，并在会话过期后自动注销。</p>
</li>
<li><p>避免暴露会话ID：不要在URL中明文传递会话ID，因为URL可能会被攻击者窃取或者劫持。</p>
</li>
<li><p>在服务器端验证用户输入：始终在服务器端对用户输入进行验证和过滤，以确保输入的安全性。</p>
</li>
</ul>
<h2 id="0x03-敏感数据泄露"><a href="#0x03-敏感数据泄露" class="headerlink" title="0x03 敏感数据泄露"></a>0x03 敏感数据泄露</h2><p>敏感数据泄露（Sensitive Data Exposure）漏洞指的是应用程序中存储的敏感数据没有得到足够的保护，导致攻击者非法获取这些敏感数据。敏感数据通常包括个人身份信息、财务信息、医疗记录等，如果这些数据被窃取，会造成严重的隐私泄露和经济损失。</p>
<h3 id="1-漏洞成因"><a href="#1-漏洞成因" class="headerlink" title="1. 漏洞成因"></a>1. 漏洞成因</h3><ul>
<li><p>加密不足：数据在传输或存储时未经加密或者加密方式不够强健，导致数据容易被窃取或者破解。</p>
</li>
<li><p>不安全的存储：应用程序将敏感数据存储在不安全的地方，如明文存储在数据库中、存储在可被公开访问的文件中等，使得攻击者可以轻松获取这些数据。</p>
</li>
<li><p>不安全的传输：应用程序在传输敏感数据时未经加密，使得攻击者可以通过网络嗅探等方式获取这些数据。</p>
</li>
<li><p>未及时更新软件或补丁：应用程序或相关组件存在漏洞时，攻击者可以利用这些漏洞来获取敏感数据。</p>
</li>
</ul>
<h3 id="2-脆弱点"><a href="#2-脆弱点" class="headerlink" title="2. 脆弱点"></a>2. 脆弱点</h3><p>首先需要确认的是哪些数据是敏感数据（包含：传输过程中的数据、存储数据）而需要被加密。例如：密码、信用卡卡号、医疗记录、个人信息应该被加密，特别是隐私法律或条例中规定需要加密的数据，如：欧盟《通用数据保护条例》（GDPR）、 属于”金融数据保护条例”的《支付卡行业数据安全标准》（PIC DSS）。对于这些数据，要确定：</p>
<ul>
<li>在数据传输过程中是否使用明文传输？这和传输协议相关，如：HTTP、SMTP和FTP。外部网络流量非常危险。验证所有的内部通信，如：负载平衡器、Web服务器或后端系统之间的通信。</li>
<li>当数据被长期存储时，无论存储在哪里，它们是否都被加密，包含备份数据？</li>
<li>无论默认条件还是源代码中，是否还在使用任何旧的或脆弱的加密算法？</li>
<li>是否使用默认加密密钥，生成或重复使用脆弱的加密密钥，或者缺少恰当的密钥管理或密钥回转？</li>
<li>是否强制加密敏感数据，例如：用户代理（如：浏览器）指令和传输协议是否被加密？</li>
<li>用户代理（如：应用程序、邮件客户端）是否未验证服务器端证书的有效性？</li>
</ul>
<h3 id="3-防御措施-1"><a href="#3-防御措施-1" class="headerlink" title="3. 防御措施"></a>3. 防御措施</h3><p>对一些需要加密的敏感数据，应该做到以下几点：</p>
<ul>
<li>对系统处理、存储或传输的数据分类，并根据分类进行访问控制。- 熟悉与敏感数据保护相关的法律和条例，并根据每项法规要求保护敏感数据。</li>
<li>对于没必要存放的、重要的敏感数据，应当尽快清除，或者通过PCI DSS标记或拦截。未存储的数据不能被窃取。</li>
<li>确保存储的所有敏感数据被加密。</li>
<li>确保使用了最新的、强大的标准算法或密码、参数、协议和密匙，并且密钥管理到位。</li>
<li>确保传输过程中的数据被加密，如：使用TLS。确保数据加密被强制执行，如：使用HTTP严格安全传输协议（HSTS ）。</li>
<li>禁止缓存对包含敏感数据的响应。</li>
<li>确保使用密码专用算法存储密码，如：Argon2 、 scrypt 、bcrypt 或者PBKDF2 。将工作因素（延迟因素）设置在可接受范围。</li>
<li>单独验证每个安全配置项的有效性。</li>
</ul>
<h3 id="4-攻击场景"><a href="#4-攻击场景" class="headerlink" title="4. 攻击场景"></a>4. 攻击场景</h3><p><strong>场景一</strong></p>
<p>一个应用程序使用自动化的数据加密系统加密信用卡信息，并存储在数据库中。但是，当数据被检索时被自动解密，这就使得SQL注入漏洞能够以明文形式获得所有信用卡卡号。</p>
<p><strong>场景二</strong></p>
<p>一个网站上对所有网页没有使用或强制使用TLS，或者使用弱加密。攻击者通过监测网络流量（如：不安全的无线网络），将网络连接从HTTPS降级到HTTP，就可以截取请求并窃取用户会话cookie。 之后，攻击者可以复制用户cookie并成功劫持经过认证的用户会话、访问或修改用户个人信息。除此之外，攻击者还可以更改所有传输过程中的数据，例如：转款的接接收者。</p>
<p><strong>场景三</strong></p>
<p>密码数据库使用未加盐的哈希算法或弱哈希算法去存储每个人的密码。一个文件上传漏洞使黑客能够获取密码文件。所有这些未加盐哈希的密码通过彩虹表暴力破解方式破解。 由简单或快速散列函数生成加盐的哈希，也可以通过GPU破解。</p>
<h2 id="0x04-XML-外部实体（XXE）"><a href="#0x04-XML-外部实体（XXE）" class="headerlink" title="0x04 XML 外部实体（XXE）"></a>0x04 XML 外部实体（XXE）</h2><p><strong>原理：</strong> 攻击者利用 XML 解析器的功能，通过在 XML 文档中插入恶意实体来触发漏洞。</p>
<p>攻击者构造一个恶意XML文件，并将其提交到目标应用程序中进行解析。在解析过程中，攻击者在XML文档中注入一些恶意的实体和引用，利用这些实体和引用来读取文件、访问网络资源、执行系统命令等操作，从而导致敏感数据泄露、服务器被控制等危害。</p>
<p><strong>成因：</strong> 在应用程序对XML文件进行解析时，没有对外部实体进行正确的限制或过滤。</p>
<h3 id="1-出现场景"><a href="#1-出现场景" class="headerlink" title="1. 出现场景"></a>1. 出现场景</h3><p>应用程序和特别是基于XML的Web服务或向下集成，可能在以下方面容易受到攻击：</p>
<ul>
<li>直接接受XML文件或上传XML文件，特别是来自不受信任的源。</li>
<li>将不受信任的数据插入XML文件并提交给XML处理器解析。</li>
<li>在应用程序或Web服务中，启用了文档类型定义（DTDs）并且处理器没有禁用DTDs。</li>
<li>使用SAML进行身份认证时，由于SAML使用XML进行身份确认，因此容易受到XXE攻击。</li>
<li>应用程序使用早于1.2版本的SOAP，并且将XML实体传递到SOAP框架。</li>
</ul>
<h3 id="2-影响危害-2"><a href="#2-影响危害-2" class="headerlink" title="2. 影响危害"></a>2. 影响危害</h3><p>XXE缺陷可用于提取数据、执行远程服务器请求、扫描内部系统、执行拒绝服务攻击和其他攻击。业务影响取决于所有受影响的应用程序和数据保护需求。</p>
<ul>
<li><p>敏感数据泄露：攻击者可以读取服务器上的敏感数据并将其泄露给未授权的第三方。</p>
</li>
<li><p>拒绝服务攻击：攻击者可以通过恶意的XML文件来耗尽服务器的资源，导致服务不可用。</p>
</li>
<li><p>服务器被控制：攻击者可以通过注入恶意代码来控制服务器，并执行恶意操作，如删除、修改、上传等。</p>
</li>
</ul>
<h3 id="3-攻击方式"><a href="#3-攻击方式" class="headerlink" title="3. 攻击方式"></a>3. 攻击方式</h3><p>XXE漏洞的攻击方式通常包括以下几种：</p>
<ul>
<li><p>基于响应的攻击（Response-based attacks）：攻击者将恶意代码嵌入XML文件中，然后将文件上传到目标网站。当目标网站对该XML文件进行解析时，攻击者可以通过观察响应内容（如错误信息、返回时间等）来判断攻击是否成功，并从中获取敏感信息。</p>
</li>
<li><p>盲注攻击（Blind XXE attacks）：攻击者通过在XML文件中插入恶意代码并请求目标网站解析该文件，然后观察目标网站的响应来判断攻击是否成功，并获取敏感信息。与基于响应的攻击不同的是，攻击者无法直接从响应中获得有用的信息，而需要进行多次请求和观察。</p>
</li>
<li><p>带外攻击（Out-of-Band XXE attacks）：攻击者通过在XML文件中插入恶意代码并请求目标网站解析该文件，然后触发目标网站向攻击者控制的外部服务器发送请求，从而将敏感信息泄漏到攻击者的服务器上。这种攻击方式通常用于绕过目标网站的防火墙或其他安全设施。</p>
</li>
<li><p>直接攻击（Direct XXE attacks）：攻击者直接向目标网站发送包含恶意代码的XML请求，从而触发目标网站解析该请求并执行其中的恶意代码。这种攻击方式通常需要攻击者事先获取目标网站的XML解析器的相关信息（如URL、参数等），因此相对较难实施。</p>
</li>
</ul>
<h3 id="3-防御措施-2"><a href="#3-防御措施-2" class="headerlink" title="3. 防御措施"></a>3. 防御措施</h3><p>开发人员培训是识别和减少XXE缺陷的关键，此外，防止XXE 缺陷还需要：</p>
<ul>
<li><p>禁用外部实体：禁用XML解析器中的外部实体可以有效防止XXE漏洞。对于一些语言和库，这可以通过设置特定选项或属性来实现。</p>
</li>
<li><p>白名单过滤输入数据：应用程序应该只接受预期格式的XML数据，并根据需要实现白名单过滤。可以在输入数据中排除任何不必要的元素，以减少攻击面。</p>
</li>
<li><p>使用最新版本的XML解析器和库：XML解析器和库的最新版本通常包含对XXE漏洞的修复和防御措施。因此，使用最新版本的库和解析器可以减少受到XXE攻击的风险。</p>
</li>
<li><p>使用安全的XML解析器：使用被广泛认可为安全的XML解析器，如SAX或DOM，以防止恶意XML数据的注入和攻击。</p>
</li>
<li><p>实现输入验证和过滤：应用程序应该对所有输入数据进行验证和过滤，以确保输入数据符合预期格式和模式。这可以减少攻击面，并提高应用程序的安全性。</p>
</li>
</ul>
<h3 id="4-攻击场景-1"><a href="#4-攻击场景-1" class="headerlink" title="4. 攻击场景"></a>4. 攻击场景</h3><p>大量XXE缺陷已经被发现并被公开，这些缺陷包括嵌入式设备的XXE缺陷。 XXE缺陷存在于许多意想不到的地方，这些地方包括深嵌套的依赖项。最简单的方法是上传可被接受的恶意XML文件：</p>
<p>场景 1：攻击者尝试从服务端提取数据：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8859-1&quot;</span>?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">foo</span> [</span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ELEMENT <span class="keyword">foo</span> <span class="keyword">ANY</span> &gt;</span></span></span><br><span class="line"><span class="meta"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///etc/passwd&quot;</span> &gt;</span>]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">foo</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">foo</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>场景 2：攻击者通过将上面的实体行更改为以下内容来探测服务器的专用网络：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;https://192.168.1.1/private&quot;</span> &gt;</span>]&gt;</span><br></pre></td></tr></table></figure>

<p>场景 3：攻击者通过恶意文件执行拒绝服务攻击：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!ENTITY <span class="keyword">xxe</span> <span class="keyword">SYSTEM</span> <span class="string">&quot;file:///dev/random&quot;</span> &gt;</span>]&gt;</span><br></pre></td></tr></table></figure>

<h2 id="0x05-失效的访问控制"><a href="#0x05-失效的访问控制" class="headerlink" title="0x05 失效的访问控制"></a>0x05 失效的访问控制</h2><p>失效的访问控制（Broken Access Control）是指在应用程序中缺乏恰当的访问控制措施，使得攻击者可以未经授权地访问系统资源或执行操作。一般来说，访问控制机制包括身份验证、授权和会话管理等方面，而失效的访问控制漏洞可能发生在这些方面的任何一个或多个环节。</p>
<h3 id="1-脆弱点-1"><a href="#1-脆弱点-1" class="headerlink" title="1. 脆弱点"></a>1. 脆弱点</h3><p>访问控制强制实施策略，使用户无法在其预期的权限之外执行行为。失败的访问控制通常导致未经授权的信息泄露、修改或销毁所有数据、或在用户权限之外执行业务功能。常见的访问控制脆弱点包括：</p>
<ul>
<li>通过修改 URL、内部应用程序状态或 HTML 页面绕过访问控制检查，或简单地使用自定义的 API 攻击工具。</li>
<li>允许将主键更改为其他用户的记录，例如查看或编辑他人的帐户。</li>
<li>特权提升。在不登录的情况下假扮用户，或以用户身份登录时充当管理员。</li>
<li>元数据操作，如重放或篡改 JWT 访问控制令牌，或作以提升权限的cookie 或隐藏字段。</li>
<li>CORS配置错误允许未授权的API访问。</li>
<li>以未通过身份验证的用户身份强制浏览的通过身份验证时才能看到的页面、或作为标准用户访问具有相关权限的页面、或API没有对POST、PUT和DELETE强制执行访问控制。</li>
</ul>
<h3 id="2-影响危害-3"><a href="#2-影响危害-3" class="headerlink" title="2. 影响危害"></a>2. 影响危害</h3><p>攻击者可以冒充用户、管理员或拥有特权的用户，或者创建、访问、更新或删除任何记录。</p>
<h3 id="3-防御措施-3"><a href="#3-防御措施-3" class="headerlink" title="3. 防御措施"></a>3. 防御措施</h3><p>访问控制只有在受信服务器端代码或没有服务器的 API 中有效，这样这样攻击者才无法修改访问控制检查或元数据。</p>
<ul>
<li>除公有资源外，默认情况下拒绝访问</li>
<li>使用一次性的访问控制机制，并在整个应用程序中不断重用它们，包括最小化跨域资源共享 (CORS) 的使用。</li>
<li>建立访问控制模型以强制执行所有权记录，而不是接受用户创建、读取、更新或删除的任何记录。</li>
<li>在域模型中强制执行业务限制。</li>
<li>禁用 Web 服务器目录列表，并确保文件元数据（如 Git）不存在于 Web 的根目录中。</li>
<li>记录失败的访问控制，并在适当时向管理员发出警报。</li>
<li>对 API 和控制器的访问进行速率限制，以最大限度地降低自动化攻击工具的危害。</li>
<li>当用户注销后，服务器上的 JSON Web Token (JWT) 令牌应失效。</li>
</ul>
<h2 id="0x06-安全配置错误"><a href="#0x06-安全配置错误" class="headerlink" title="0x06 安全配置错误"></a>0x06 安全配置错误</h2><p>安全配置错误是系统管理员或开发人员在配置安全措施时出现了疏漏或错误，使得攻击者可以利用这些漏洞绕过安全控制，从而达到攻击的目的。</p>
<h3 id="1-脆弱点-2"><a href="#1-脆弱点-2" class="headerlink" title="1. 脆弱点"></a>1. 脆弱点</h3><p>您的应用程序可能受到攻击，如果应用程序是：</p>
<ul>
<li>应用程序栈堆的任何部分都缺少适当的安全加固，或者云服务的<br>权限配置错误。</li>
<li>应用程序启用或安装了不必要的功能（例如：不必要的端口、服<br>务、网页、帐户或权限）。</li>
<li>默认帐户的密码仍然可用且没有更改。</li>
<li>错误处理机制向用户披露堆栈跟踪或其他大量错误信息。</li>
<li>对于更新的系统，禁用或不安全地配置最新的安全功能。</li>
<li>应用程序服务器、应用程序框架（如：Struts、Spring、<br>ASP.NET）、库文件、数据库等没有进行安全配置。</li>
<li>服务器不发送安全标头或指令，或者未对服务器进行安全配置。</li>
<li>您的应用软件已过期或易受攻击（参见A9：2017-使用含有已知<br>漏洞的组件）。</li>
</ul>
<p>缺少一个体系的、可重复的应用程序安全配置过程，系统将处于高风险中。</p>
<h3 id="2-防御措施"><a href="#2-防御措施" class="headerlink" title="2. 防御措施"></a>2. 防御措施</h3><p>应实施安全的安装过程，包括：</p>
<ul>
<li>一个可以快速且易于部署在另一个锁定环境的可重复的加固过程。开发、质量保证和生产环境都应该进行相同配置，并且，在每个环境中使用不同的密码。这个过程应该是自动化的，以尽量减少安装一个新安全环境的耗费。</li>
<li>搭建最小化平台，该平台不包含任何不必要的功能、组件、文档和示例。移除或不安装不适用的功能和框架。</li>
<li>检查和修复安全配置项来适应最新的安全说明、更新和补丁，并将其作为更新管理过程的一部分，（参见A9：2017-使用含有已知漏洞的组件）。在检查过程中，应特别注意云存储权限（如：S3桶权限）。</li>
<li>一个能在组件和用户间提供有效的分离和安全性的分段应用程序架构，包括：分段、容器化和云安全组。</li>
<li>向客户端发送安全指令，如：安全标头。</li>
<li>在所有环境中能够进行正确安全配置和设置的自动化过程。</li>
</ul>
<h3 id="3-攻击场景"><a href="#3-攻击场景" class="headerlink" title="3. 攻击场景"></a>3. 攻击场景</h3><p><strong>场景1</strong>：应用程序服务器附带了未从产品服务器中删除的应用程序样例。这些样例应用程序具有已知的安全漏洞，攻击者利用这<br>些漏洞来攻击服务器。如果其中一个应用程序是管理员控制台，并且没有更改默认账户，攻击者就可以通过默认密码登录，从而接管服务器。</p>
<p><strong>场景2</strong>：目录列表在服务器端未被禁用。攻击者发现他们很容易就能列出目录列表。攻击者找到并下载所有已编译的Java类，他们通过反编译来查看代码。然后，攻击者在应用程序中找到一个严重的访问控制漏洞。</p>
<p><strong>场景3</strong>：应用服务器配置允许将详细的错误信（如：堆栈跟踪信息）返回给用户，这可能会暴露敏感信息或潜在的漏洞，如：已知含有漏洞的组件的版本信息。</p>
<p><strong>场景4</strong>：云服务向其他CSP用户提供默认的网络共享权限。这允许攻击者访问存储在云端的敏感数据。</p>
<h2 id="0x07-跨站脚本（XSS）"><a href="#0x07-跨站脚本（XSS）" class="headerlink" title="0x07 跨站脚本（XSS）"></a>0x07 跨站脚本（XSS）</h2><p>当应用程序的新网页中包含不受信任的、未经恰当验证或转义的数据时，或者使用可以创建 HTML或JavaScript 的浏览器 API 更新现有的网页时，就会出现 XSS 缺陷。XSS 让攻击者能够在受害者的浏览器中执行脚本，并劫持用户会话、破坏网站或将用户重定向到恶意站点。</p>
<h3 id="1-XSS类型"><a href="#1-XSS类型" class="headerlink" title="1. XSS类型"></a>1. XSS类型</h3><p><strong>1）反射式XSS：</strong></p>
<p>应用程序或API包括未经验证和未经转义的用户输入，作为HTML输出的一部分。一个成功的攻击可以让攻击者在受害者的浏览器中执行任意的HTML和JavaScript。 通常，用户将需要与指向攻击者控制页面的某些恶意链接进行交互，例如恶意漏洞网站，广告或类似内容。</p>
<p><strong>2）存储式XSS：</strong></p>
<p>应用或者API将未净化的用户输入存储下来了，并在后期在其他用户或者管理员的页面展示出来。 存储型XSS一般被认为是高危或严重的风险。</p>
<p><strong>3）基于DOM的XSS：</strong></p>
<p>会动态的将攻击者可控的内容加入页面的JavaScript框架、单页面程序或API存在这种类型的漏洞。理想的来说，你应该避免将攻击者可控的数据发送给不安全的JavaScriptAPI。</p>
<h3 id="2-影响危害-4"><a href="#2-影响危害-4" class="headerlink" title="2. 影响危害"></a>2. 影响危害</h3><p>典型的XSS攻击可导致盗取session、账户、绕过MFA、DIV替换、对用户浏览器的攻击（例如：恶意软件下载、键盘记录）以及其他用户侧的攻击。</p>
<p>XSS对于反射和DOM的影响是中等的，而对于存储的XSS，XSS的影响更为严重，譬如在受攻击者的浏览器上执行远程代码。</p>
<h3 id="3-防御措施-4"><a href="#3-防御措施-4" class="headerlink" title="3. 防御措施"></a>3. 防御措施</h3><p>防止XSS需要将不可信数据与动态的浏览器内容区分开。这可以通过如下步骤实现：</p>
<ul>
<li>使用设计上就会自动编码来解决XSS问题的框架，如：Ruby 3.0或 React JS。了解每个框架的XSS保护的局限性，并适当地处理未覆盖的用例。</li>
<li>为了避免反射式或存储式的XSS漏洞，最好的办法是根据HTML输出的上下文（包括：主体、属性、JavaScript、CSS或URL）对所有不可信的HTTP请求数据进行恰当的转义 。</li>
<li>在客户端修改浏览器文档时，为了避免DOM XSS攻击，最好的选择是实施上下文敏感数据编码。</li>
<li>使用内容安全策略（CSP）是对抗XSS的深度防御策略。如果不存在可以通过本地文件放置恶意代码的其他漏洞（例如：路径遍历覆盖和允许在网络中传输的易受攻击的库），则该策略是有效的。</li>
</ul>
<h2 id="0x08-不安全的反序列化"><a href="#0x08-不安全的反序列化" class="headerlink" title="0x08 不安全的反序列化"></a>0x08 不安全的反序列化</h2><p>不安全的反序列化会导致远程代码执行。即使反序列化缺陷不会导致远程代码执行，攻击者也可以利用它们来执行攻击，包括：重播攻击、注入攻击和特权升级攻击。</p>
<h3 id="1-脆弱点-3"><a href="#1-脆弱点-3" class="headerlink" title="1. 脆弱点"></a>1. 脆弱点</h3><p>如果反序列化进攻者提供的敌意或者篡改过的对象将会使将应用程序和API变的脆弱。</p>
<p>这可能导致两种主要类型的攻击：</p>
<ul>
<li>如果应用中存在可以在反序列化过程中或者之后被改变行为的类，则攻击者可以通过改变应用逻辑或者实现远程代码执行攻击。我们将其称为对象和数据结构攻击。</li>
<li>典型的数据篡改攻击，如访问控制相关的攻击，其中使用了现有的数据结构，但内容发生了变化。</li>
</ul>
<p>在应用程序中，序列化可能被用于:</p>
<ul>
<li>远程和进程间通信（RPC &#x2F; IPC）</li>
<li>连线协议、Web服务、消息代理</li>
<li>缓存&#x2F;持久性</li>
<li>数据库、缓存服务器、文件系统</li>
<li>HTTP cookie、HTML表单参数、API身份验证令牌</li>
</ul>
<h3 id="2-防御措施-1"><a href="#2-防御措施-1" class="headerlink" title="2. 防御措施"></a>2. 防御措施</h3><p>唯一安全的架构模式是不接受来自不受信源的序列化对象，或使用只允许原始数据类型的序列化媒体。</p>
<p>如果上述不可能的话，考虑使用下述方法：</p>
<ul>
<li>执行完整性检查，如：任何序列化对象的数字签名，以防止恶意对象创建或数据篡改。</li>
<li>在创建对象之前强制执行严格的类型约束，因为代码通常被期望成一组可定义的类。绕过这种技术的方法已经被证明，所以完全依赖于它是不可取的。</li>
<li>如果可能，隔离运行那些在低特权环境中反序列化的代码。</li>
<li>记录反序列化的例外情况和失败信息，如：传入的类型不是预期的类型，或者反序列处理引发的例外情况。</li>
<li>限制或监视来自于容器或服务器传入和传出的反序列化网络连接。</li>
<li>监控反序列化，当用户持续进行反序列化时，对用户进行警告</li>
</ul>
<h3 id="3-攻击场景-1"><a href="#3-攻击场景-1" class="headerlink" title="3. 攻击场景"></a>3. 攻击场景</h3><p><strong>场景 1：</strong></p>
<p>一个React应用程序调用了一组Spring Boot微服务。作<br>为功能性程序员，他们试图确保他们的代码是不可变的。他们提<br>出的解决方法是序列化用户状态，并在每次请求时来回传递。攻<br>击者注意到了”R00”Java对象签名，并使用Java Serial Killer工<br>具在应用服务器上获得远程代码执行。</p>
<p><strong>场景 2：</strong></p>
<p>一个PHP论坛使用PHP对象序列化来保存一个”超级”cookie。该cookie包含了用户的用户ID、角色、密码哈希和其<br>他状态：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a:4:&#123;i:0;i:132;i:1;s:7:&quot;Mallory&quot;;i:2;s:4:&quot;user&quot;;i:3;s:32:&quot;b6a8b3bea87fe0e05022f8f3c88bc960&quot;;&#125;</span><br><span class="line"></span><br><span class="line">攻击者更改序列化对象以授予自己为admin权限：</span><br><span class="line"></span><br><span class="line">a:4:&#123;i:0;i:1;i:1;s:5:&quot;Alice&quot;;i:2;s:5:&quot;admin&quot;;i:3;s:32:&quot;b6a8b3bea87fe0e05022f8f3c88bc960&quot;;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="0x09-使用含有已知漏洞的组件"><a href="#0x09-使用含有已知漏洞的组件" class="headerlink" title="0x09 使用含有已知漏洞的组件"></a>0x09 使用含有已知漏洞的组件</h2><p>组件（例如：库、框架和其他软件模块）拥有和应用程序相同的权限。如果应用程序中含有已知漏洞的组件被攻击者利用，可能会造成严重的数据丢失或服务器接管。同时，使用含有已知漏洞的组件的应用程序和API可能会破坏应用程序防御、造成各种攻击并产生严重影响。</p>
<h3 id="1-脆弱点-4"><a href="#1-脆弱点-4" class="headerlink" title="1. 脆弱点"></a>1. 脆弱点</h3><p>如果满足下面的某个条件，那么你的应用就易受此类攻击：</p>
<ul>
<li>如果你不知道所有使用的组件版本信息（包括：服务端和客户端）。这包括了直接使用的组件或其依赖的组件。</li>
<li>如果软件易受攻击，不再支持或者过时。这包括：OS、Web服务器、应用程序服务器、数据库管理系统（DBMS）、应用程序、API和所有的组件、运行环境和库。</li>
<li>如果你不会定期做漏洞扫描和订阅你使用组件的安全公告。</li>
<li>如果你不基于风险并及时修复或升级底层平台、框架和依赖库。很可能发生这种情况：根据变更控制，每月或每季度进行升级，这使得组织在这段时间内会受到已修复但未修补的漏洞的威胁。</li>
<li>如果软件工程师没有对更新的、升级的或打过补丁的组件进行兼容性测试。</li>
<li>如果你没有对组件进行安全配置（请参考”A6:2017-安全配置错误”）。</li>
</ul>
<h3 id="2-防御措施-2"><a href="#2-防御措施-2" class="headerlink" title="2. 防御措施"></a>2. 防御措施</h3><p>应该制定一个补丁管理流程：</p>
<ul>
<li>移除不使用的依赖、不需要的功能、组件、文件和文档。</li>
<li>利用如 versions、DependencyCheck 、retire.js等工具来持续的记录客户端和服务器端以及它们的依赖库的版本信息。持续监控如CVE 和 NVD等是否发布已使用组件的漏洞信息，可以使用软件分析工具来自动完成此功能。订阅关于使用组件安全漏洞的警告邮件。</li>
<li>仅从官方渠道安全的获取组件，并使用签名机制来降低组件被篡改或加入恶意漏洞的风险</li>
<li>监控那些不再维护或者不发布安全补丁的库和组件。如果不能打补丁，可以考虑部署虚拟补丁来监控、检测或保护。</li>
</ul>
<h2 id="0x0A-不足的日志记录和监控"><a href="#0x0A-不足的日志记录和监控" class="headerlink" title="0x0A 不足的日志记录和监控"></a>0x0A 不足的日志记录和监控</h2><p>不足的日志记录和监控，以及事件响应缺失或无效的集成，使攻击者能够进一步攻击系统、保持持续性或转向更多系统，以及篡改、提取或销毁数据。大多数缺陷研究显示，缺陷被检测出的时间超过200天，且通常通过外部检测方检测，而不是通过内部流程或监控检测。</p>
<h3 id="1-脆弱点-5"><a href="#1-脆弱点-5" class="headerlink" title="1. 脆弱点"></a>1. 脆弱点</h3><p>下列情况会导致不足的日志记录、检测、监控和响应：</p>
<ul>
<li>未记录可审计性事件，如：登录、登录失败和高额交易。</li>
<li>告警和错误事件未能产生或产生不足的和不清晰的日志信息。</li>
<li>没有利用应用系统和API的日志信息来监控可疑活动。</li>
<li>日志信息仅在本地存储。</li>
<li>没有定义合理的告警阈值和制定响应处理流程。</li>
<li>渗透测试和使用DAST工具（如：OWASP ZAP）扫描没有触发告警</li>
<li>对于实时或准实时的攻击，应用程序无法检测、处理和告警</li>
</ul>
<h3 id="2-防御措施-3"><a href="#2-防御措施-3" class="headerlink" title="2. 防御措施"></a>2. 防御措施</h3><p>根据应用程序存储或处理的数据的风险：</p>
<ul>
<li>确保所有登录、访问控制失败、输入验证失败能够被记录到日志中去，并保留足够的用户上下文信息，以识别可疑或恶意帐户，并为后期取证预留足够时间。</li>
<li>确保日志以一种能被集中日志管理解决方案使用的形式生成</li>
<li>确保高额交易有完整性控制的审计信息，以防止篡改或删除，例如审计信息保存在只能进行记录增加的数据库表中。</li>
<li>建立有效的监控和告警机制，使可疑活动在可接受的时间内被发现和应对。</li>
<li>建立或采取一个应急响应机制和恢复计划，例如：NIST 800-61 rev 2或更新版本。</li>
</ul>
<h2 id="0xFF-Reference"><a href="#0xFF-Reference" class="headerlink" title="0xFF Reference"></a>0xFF Reference</h2><ul>
<li><a target="_blank" rel="noopener" href="https://owasp.org/www-project-top-ten/">https://owasp.org/www-project-top-ten/</a></li>
<li><a target="_blank" rel="noopener" href="https://cheatsheetseries.owasp.org/">https://cheatsheetseries.owasp.org/</a></li>
<li><a target="_blank" rel="noopener" href="https://wiki.owasp.org/index.php/OWASP_Guide_Project">https://wiki.owasp.org/index.php/OWASP_Guide_Project</a></li>
<li><a target="_blank" rel="noopener" href="https://owasp.org/www-project-web-security-testing-guide/">https://owasp.org/www-project-web-security-testing-guide/</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Vulnerability/" rel="tag" <i class="fa fa-tag"></i> Vulnerability</a>
              <a href="/tags/OWASP/" rel="tag" <i class="fa fa-tag"></i> OWASP</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/posts/46803/" rel="prev" title="Nmap扫描指南">
                  <i class="fa fa-chevron-left"></i> Nmap扫描指南
                </a>
            </div>
            <div class="post-nav-item">
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">L0n9w4y</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  




  <script src="/js/third-party/pace.js"></script>

  





</body>
</html>
